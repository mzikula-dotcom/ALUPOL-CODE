import { PrismaClient, SurchargeCategory, SurchargeType, UserRole } from '@prisma/client'
import * as bcrypt from 'bcryptjs'

const prisma = new PrismaClient()

// ==================== TYPY ZASTŘEŠENÍ ====================
const roofTypes = [
  { code: 'PRACTIC', name: 'Practic', maxWidth: 5500, minWidth: 2000, hasSkirts: false, sortOrder: 1 },
  { code: 'HARMONY', name: 'Harmony', maxWidth: 6000, minWidth: 2000, hasSkirts: true, sortOrder: 2 },
  { code: 'DREAM', name: 'Dream', maxWidth: 6000, minWidth: 2000, hasSkirts: true, sortOrder: 3 },
  { code: 'HORIZONT', name: 'Horizont', maxWidth: 6000, minWidth: 2000, hasSkirts: false, sortOrder: 4 },
  { code: 'STAR', name: 'Star', maxWidth: 5500, minWidth: 2000, hasSkirts: true, sortOrder: 5 },
  { code: 'ROCK', name: 'Rock', maxWidth: 6000, minWidth: 2000, hasSkirts: false, sortOrder: 6 },
  { code: 'TERRACE', name: 'Terrace', maxWidth: 5000, minWidth: 1750, hasSkirts: true, sortOrder: 7 },
  { code: 'WAVE', name: 'Wave', maxWidth: 5000, minWidth: 3100, hasSkirts: false, sortOrder: 8 },
  { code: 'FLASH', name: 'Flash', maxWidth: 5000, minWidth: 2000, hasSkirts: false, sortOrder: 9 },
  { code: 'WING', name: 'Wing', maxWidth: 5000, minWidth: 2000, hasSkirts: false, sortOrder: 10 },
  { code: 'SUNSET', name: 'SunSet', maxWidth: 5500, minWidth: 2000, hasSkirts: false, sortOrder: 11 },
]

// ==================== CENÍKY ====================
// Formát: [widthLabel, widthMin, widthMax, [cena2, výška2], [cena3, výška3], ...]
type PriceRow = [string, number, number, ...[number, number][]]

const priceData: Record<string, PriceRow[]> = {
  PRACTIC: [
    ['do 3 m', 2000, 3000, [60461, 0.91], [84067, 0.96], [118839, 1.01], [148254, 1.06], [179550, 1.11], [212648, 1.16]],
    ['do 3,25 m', 3001, 3250, [63496, 0.98], [88016, 1.03], [122330, 1.08], [152373, 1.13], [184166, 1.18], [217770, 1.23]],
    ['do 3,5 m', 3251, 3500, [66532, 1.05], [91965, 1.10], [126931, 1.15], [157877, 1.20], [190459, 1.25], [224879, 1.30]],
    ['do 3,75 m', 3501, 3750, [72106, 1.12], [99702, 1.17], [131130, 1.22], [162726, 1.27], [195997, 1.32], [230901, 1.37]],
    ['do 4 m', 3751, 4000, [76766, 1.19], [106113, 1.24], [137069, 1.29], [169747, 1.34], [204162, 1.39], [240035, 1.44]],
    ['do 4,25 m', 4001, 4250, [78944, 1.26], [108822, 1.31], [140340, 1.36], [173518, 1.41], [208335, 1.46], [246388, 1.51]],
    ['do 4,5 m', 4251, 4500, [81853, 1.33], [112543, 1.38], [144917, 1.43], [178905, 1.48], [214452, 1.53], [255027, 1.58]],
    ['do 4,75 m', 4501, 4750, [87470, 1.40], [119552, 1.45], [155692, 1.50], [188648, 1.55], [225607, 1.60], [265889, 1.65]],
    ['do 5 m', 4751, 5000, [93087, 1.47], [126561, 1.52], [166467, 1.57], [198391, 1.62], [236762, 1.67], [276751, 1.72]],
    ['do 5,25 m', 5001, 5250, [97395, 1.54], [132255, 1.59], [171111, 1.64], [206824, 1.69], [246599, 1.74], [287925, 1.79]],
    ['do 5,5 m', 5251, 5500, [101702, 1.61], [137949, 1.66], [175755, 1.71], [215257, 1.76], [256437, 1.81], [299099, 1.86]],
  ],
  HARMONY: [
    ['do 3 m', 2000, 3000, [108923, 2.10], [145123, 2.12], [182707, 2.14], [221323, 2.15], [261720, 2.17], [305240, 2.19]],
    ['do 3,25 m', 3001, 3250, [115908, 2.11], [154899, 2.13], [195272, 2.15], [236857, 2.16], [280154, 2.18], [326615, 2.20]],
    ['do 3,5 m', 3251, 3500, [122893, 2.12], [164675, 2.14], [207837, 2.16], [252391, 2.17], [298588, 2.19], [347989, 2.21]],
    ['do 3,75 m', 3501, 3750, [130075, 2.13], [173948, 2.15], [219224, 2.17], [265811, 2.18], [314271, 2.20], [365893, 2.22]],
    ['do 4 m', 3751, 4000, [137256, 2.14], [183221, 2.16], [230611, 2.18], [279232, 2.19], [329955, 2.21], [383797, 2.23]],
    ['do 4,25 m', 4001, 4250, [141469, 2.16], [188627, 2.18], [237265, 2.20], [287115, 2.21], [339035, 2.23], [394131, 2.25]],
    ['do 4,5 m', 4251, 4500, [145682, 2.17], [194033, 2.19], [243919, 2.21], [294998, 2.22], [348116, 2.24], [404464, 2.26]],
    ['do 4,75 m', 4501, 4750, [155784, 2.18], [207506, 2.20], [260789, 2.22], [315304, 2.23], [371907, 2.25], [431773, 2.27]],
    ['do 5 m', 4751, 5000, [165885, 2.20], [220979, 2.22], [277658, 2.24], [335610, 2.25], [395698, 2.27], [459081, 2.29]],
    ['do 5,25 m', 5001, 5250, [172474, 2.21], [229821, 2.23], [288764, 2.25], [349013, 2.26], [411356, 2.28], [477086, 2.30]],
    ['do 5,5 m', 5251, 5500, [179062, 2.23], [238664, 2.25], [299871, 2.27], [362417, 2.28], [427013, 2.30], [495091, 2.32]],
    ['do 5,75 m', 5501, 5750, [195932, 2.24], [262008, 2.26], [329753, 2.28], [398839, 2.30], [470162, 2.32], [544892, 2.34]],
    ['do 6 m', 5751, 6000, [212802, 2.26], [285352, 2.28], [359635, 2.29], [435261, 2.31], [513311, 2.33], [594693, 2.35]],
  ],
  DREAM: [
    ['do 3 m', 2000, 3000, [78918, 0.54], [112264, 0.61], [148237, 0.68], [186385, 0.75], [228151, 0.82], [282332, 0.89]],
    ['do 3,25 m', 3001, 3250, [84000, 0.55], [119670, 0.62], [158107, 0.69], [198795, 0.76], [243227, 0.83], [299240, 0.90]],
    ['do 3,5 m', 3251, 3500, [87847, 0.57], [124602, 0.64], [164267, 0.71], [206258, 0.78], [250882, 0.85], [307492, 0.92]],
    ['do 3,75 m', 3501, 3750, [92373, 0.60], [130990, 0.67], [172567, 0.74], [217543, 0.81], [264214, 0.88], [319747, 0.95]],
    ['do 4 m', 3751, 4000, [96899, 0.62], [137378, 0.69], [180867, 0.76], [228828, 0.83], [277546, 0.90], [332002, 0.97]],
    ['do 4,25 m', 4001, 4250, [100883, 0.64], [142480, 0.71], [187078, 0.78], [235080, 0.85], [284805, 0.92], [339887, 0.99]],
    ['do 4,5 m', 4251, 4500, [104867, 0.66], [147581, 0.73], [193289, 0.80], [241331, 0.87], [292064, 0.94], [347773, 1.01]],
    ['do 4,75 m', 4501, 4750, [112610, 0.68], [158432, 0.75], [207403, 0.82], [258777, 0.89], [312929, 0.96], [372176, 1.03]],
    ['do 5 m', 4751, 5000, [120353, 0.70], [169282, 0.77], [221516, 0.84], [276222, 0.91], [333794, 0.98], [396579, 1.05]],
    ['do 5,25 m', 5001, 5250, [126814, 0.72], [178466, 0.79], [233462, 0.86], [291761, 0.93], [352289, 1.00], [418080, 1.07]],
    ['do 5,5 m', 5251, 5500, [133276, 0.74], [187649, 0.81], [245408, 0.88], [307300, 0.95], [370785, 1.02], [439580, 1.09]],
    ['do 5,75 m', 5501, 5750, [144502, 0.76], [203384, 0.83], [266436, 0.90], [331689, 0.97], [399017, 1.04], [471119, 1.11]],
    ['do 6 m', 5751, 6000, [155729, 0.78], [219119, 0.85], [287463, 0.92], [356078, 0.99], [427249, 1.06], [502657, 1.13]],
  ],
  HORIZONT: [
    ['do 3 m', 2000, 3000, [59038, 0.70], [83590, 0.77], [110618, 0.84], [138553, 0.91], [168317, 0.98], [199813, 1.05]],
    ['do 3,25 m', 3001, 3250, [64626, 0.72], [91504, 0.79], [121156, 0.86], [151676, 0.93], [184104, 1.00], [218325, 1.07]],
    ['do 3,5 m', 3251, 3500, [69134, 0.75], [97259, 0.82], [127375, 0.89], [159399, 0.96], [193411, 1.03], [229279, 1.10]],
    ['do 3,75 m', 3501, 3750, [72850, 0.77], [102300, 0.84], [133739, 0.91], [167105, 0.98], [202453, 1.05], [239650, 1.12]],
    ['do 4 m', 3751, 4000, [76567, 0.80], [107342, 0.87], [140103, 0.94], [174811, 1.01], [211494, 1.08], [250022, 1.15]],
    ['do 4,25 m', 4001, 4250, [80706, 0.82], [112399, 0.89], [146105, 0.96], [181729, 1.03], [219320, 1.10], [259246, 1.17]],
    ['do 4,5 m', 4251, 4500, [84845, 0.85], [117456, 0.92], [152108, 0.99], [188648, 1.06], [227146, 1.13], [268471, 1.20]],
    ['do 4,75 m', 4501, 4750, [88628, 0.87], [122556, 0.94], [160356, 1.01], [194449, 1.08], [236195, 1.15], [278383, 1.22]],
    ['do 5 m', 4751, 5000, [92412, 0.90], [127656, 0.97], [168605, 1.04], [204073, 1.11], [245245, 1.18], [288295, 1.25]],
    ['do 5,25 m', 5001, 5250, [98660, 0.92], [136547, 0.99], [178342, 1.06], [218404, 1.13], [262352, 1.20], [308249, 1.27]],
    ['do 5,5 m', 5251, 5500, [104909, 0.95], [145439, 1.02], [188080, 1.09], [232735, 1.16], [279458, 1.23], [328203, 1.30]],
    ['do 5,75 m', 5501, 5750, [112026, 0.97], [154988, 1.04], [200081, 1.11], [247229, 1.18], [296490, 1.25], [347778, 1.32]],
    ['do 6 m', 5751, 6000, [119142, 1.00], [164537, 1.07], [212083, 1.14], [261724, 1.21], [313522, 1.28], [367352, 1.35]],
  ],
  STAR: [
    ['do 3 m', 2000, 3000, [102513, 2.04], [144888, 2.09], [190728, 2.14], [239439, 2.19], [291293, 2.24], [361162, 2.29]],
    ['do 3,25 m', 3001, 3250, [109221, 2.05], [154661, 2.10], [203753, 2.15], [255816, 2.20], [311187, 2.25], [383476, 2.30]],
    ['do 3,5 m', 3251, 3500, [115929, 2.07], [164433, 2.12], [216778, 2.17], [272193, 2.22], [331082, 2.27], [405789, 2.32]],
    ['do 3,75 m', 3501, 3750, [121902, 2.10], [172864, 2.15], [227732, 2.20], [287086, 2.25], [348676, 2.30], [421961, 2.35]],
    ['do 4 m', 3751, 4000, [127875, 2.12], [181295, 2.17], [238685, 2.22], [301978, 2.27], [366269, 2.32], [438133, 2.37]],
    ['do 4,25 m', 4001, 4250, [133132, 2.14], [188026, 2.19], [246882, 2.24], [310228, 2.29], [375849, 2.34], [448540, 2.39]],
    ['do 4,5 m', 4251, 4500, [138390, 2.16], [194758, 2.21], [255079, 2.26], [318478, 2.31], [385429, 2.36], [458946, 2.41]],
    ['do 4,75 m', 4501, 4750, [148608, 2.18], [209078, 2.23], [273704, 2.28], [341500, 2.33], [412964, 2.38], [491150, 2.43]],
    ['do 5 m', 4751, 5000, [158826, 2.20], [223397, 2.25], [292328, 2.30], [364522, 2.35], [440499, 2.40], [523355, 2.45]],
    ['do 5,25 m', 5001, 5250, [167353, 2.22], [235516, 2.27], [308093, 2.32], [385029, 2.37], [464906, 2.42], [551728, 2.47]],
    ['do 5,5 m', 5251, 5500, [175880, 2.24], [247636, 2.29], [323858, 2.34], [405536, 2.39], [489314, 2.44], [580102, 2.49]],
  ],
  ROCK: [
    ['do 3 m', 2000, 3000, [69072, 1.50], [97114, 1.57], [126996, 1.63], [158996, 1.70], [193071, 1.76], [229094, 1.83]],
    ['do 3,25 m', 3001, 3250, [75146, 1.60], [105716, 1.67], [138451, 1.73], [173260, 1.80], [210230, 1.86], [249216, 1.93]],
    ['do 3,5 m', 3251, 3500, [83225, 1.73], [116676, 1.80], [152285, 1.86], [190012, 1.93], [229885, 1.99], [271763, 2.06]],
    ['do 3,75 m', 3501, 3750, [87724, 1.85], [122173, 1.92], [158810, 1.98], [197532, 2.05], [238391, 2.11], [281790, 2.18]],
    ['do 4 m', 3751, 4000, [92223, 1.98], [127669, 2.05], [165334, 2.11], [205052, 2.18], [246897, 2.24], [291816, 2.31]],
    ['do 4,25 m', 4001, 4250, [96335, 2.08], [133213, 2.15], [174300, 2.21], [211357, 2.28], [256734, 2.34], [302590, 2.41]],
    ['do 4,5 m', 4251, 4500, [100447, 2.20], [138757, 2.27], [183266, 2.33], [221818, 2.40], [266570, 2.46], [313364, 2.53]],
    ['do 4,75 m', 4501, 4750, [107240, 2.30], [148421, 2.37], [193850, 2.43], [237395, 2.50], [285165, 2.56], [335053, 2.63]],
    ['do 5 m', 4751, 5000, [114032, 2.43], [158086, 2.50], [204434, 2.56], [252973, 2.63], [303759, 2.69], [356743, 2.76]],
    ['do 5,25 m', 5001, 5250, [121767, 2.55], [168465, 2.62], [217480, 2.68], [268728, 2.75], [322272, 2.81], [378019, 2.88]],
    ['do 5,5 m', 5251, 5500, [129503, 2.68], [178845, 2.75], [230525, 2.81], [284482, 2.88], [340785, 2.94], [399296, 3.01]],
    ['do 5,75 m', 5501, 5750, [154793, 2.78], [215751, 2.85], [279344, 2.91], [345413, 2.98], [414041, 3.04], [485173, 3.11]],
    ['do 6 m', 5751, 6000, [161484, 2.90], [225085, 2.97], [291329, 3.03], [360096, 3.10], [431511, 3.16], [505422, 3.23]],
  ],
  TERRACE: [
    ['do 2 m', 1750, 2000, [81151, 2.20], [117726, 2.27], [150820, 2.33], [185997, 2.40], [222908, 2.46], [260527, 2.53]],
    ['do 2,25 m', 2001, 2250, [85502, 2.25], [122482, 2.32], [155055, 2.38], [191776, 2.45], [228691, 2.51], [268473, 2.58]],
    ['do 2,5 m', 2251, 2500, [89852, 2.30], [127239, 2.37], [159289, 2.43], [197554, 2.50], [234473, 2.56], [276419, 2.63]],
    ['do 2,75 m', 2501, 2750, [92882, 2.34], [132623, 2.41], [165615, 2.47], [204107, 2.54], [241393, 2.60], [284343, 2.67]],
    ['do 3 m', 2751, 3000, [95913, 2.38], [138006, 2.45], [171941, 2.51], [210660, 2.58], [248314, 2.64], [292268, 2.71]],
    ['do 3,25 m', 3001, 3250, [101691, 2.43], [144878, 2.50], [180682, 2.56], [221350, 2.63], [262355, 2.69], [306923, 2.76]],
    ['do 3,5 m', 3251, 3500, [107470, 2.47], [151750, 2.54], [189424, 2.60], [232039, 2.67], [276397, 2.73], [321578, 2.80]],
    ['do 3,75 m', 3501, 3750, [111224, 2.51], [156178, 2.58], [196332, 2.64], [240043, 2.71], [285483, 2.77], [331738, 2.84]],
    ['do 4 m', 3751, 4000, [114978, 2.56], [160606, 2.63], [203241, 2.69], [248047, 2.76], [294569, 2.82], [341898, 2.89]],
    ['do 4,25 m', 4001, 4250, [122907, 2.60], [171704, 2.67], [215556, 2.73], [263115, 2.80], [311877, 2.86], [364127, 2.93]],
    ['do 4,5 m', 4251, 4500, [130835, 2.65], [182802, 2.72], [227872, 2.78], [278182, 2.85], [329185, 2.91], [386357, 2.98]],
    ['do 4,75 m', 4501, 4750, [140260, 2.69], [194040, 2.76], [244000, 2.82], [297761, 2.89], [352752, 2.95], [411336, 3.02]],
    ['do 5 m', 4751, 5000, [149684, 2.74], [205277, 2.81], [260128, 2.87], [317339, 2.94], [376319, 3.00], [436316, 3.07]],
  ],
  WAVE: [
    ['do 3,25 m', 3100, 3250, [88988, 1.95], [122889, 2.02], [158656, 2.09], [197060, 2.16], [236790, 2.23], [277161, 2.26]],
    ['do 3,5 m', 3251, 3500, [91760, 1.95], [126451, 2.02], [163027, 2.09], [202914, 2.16], [243479, 2.23], [283969, 2.26]],
    ['do 3,75 m', 3501, 3750, [96334, 1.95], [133943, 2.02], [172278, 2.09], [213258, 2.16], [256229, 2.23], [298437, 2.26]],
    ['do 4 m', 3751, 4000, [100909, 1.95], [141434, 2.02], [181529, 2.09], [223602, 2.16], [268979, 2.23], [312905, 2.26]],
    ['do 4,25 m', 4001, 4250, [114141, 1.95], [157495, 2.02], [204133, 2.09], [251681, 2.16], [301355, 2.23], [350740, 2.26]],
    ['do 4,5 m', 4251, 4500, [118032, 1.95], [163925, 2.02], [210795, 2.09], [260309, 2.16], [311368, 2.23], [362089, 2.26]],
    ['do 4,75 m', 4501, 4750, [121922, 1.95], [170355, 2.02], [217456, 2.09], [268937, 2.16], [321381, 2.23], [373438, 2.26]],
    ['do 5 m', 4751, 5000, [127032, 1.95], [174074, 2.02], [223211, 2.09], [274414, 2.16], [327749, 2.23], [380664, 2.26]],
  ],
  FLASH: [
    ['do 3 m', 2000, 3000, [70201, 0.40], [102137, 0.47], [135238, 0.54], [170816, 0.61], [206304, 0.68], [246671, 0.75]],
    ['do 3,25 m', 3001, 3250, [72919, 0.43], [105790, 0.50], [139834, 0.57], [176382, 0.64], [212686, 0.71], [254061, 0.78]],
    ['do 3,5 m', 3251, 3500, [75636, 0.45], [109443, 0.52], [144431, 0.59], [181948, 0.66], [219069, 0.73], [261450, 0.80]],
    ['do 3,75 m', 3501, 3750, [80146, 0.48], [115177, 0.55], [151775, 0.62], [190660, 0.69], [229043, 0.76], [272858, 0.83]],
    ['do 4 m', 3751, 4000, [84655, 0.51], [120912, 0.58], [159119, 0.65], [199371, 0.72], [239017, 0.79], [284265, 0.86]],
    ['do 4,25 m', 4001, 4250, [91085, 0.54], [131437, 0.61], [172534, 0.68], [215756, 0.75], [261158, 0.82], [306631, 0.89]],
    ['do 4,5 m', 4251, 4500, [94298, 0.57], [135839, 0.64], [178010, 0.71], [222313, 0.78], [268777, 0.85], [315297, 0.92]],
    ['do 4,75 m', 4501, 4750, [97511, 0.61], [140241, 0.68], [183487, 0.75], [228870, 0.82], [276397, 0.89], [323963, 0.96]],
    ['do 5 m', 4751, 5000, [100897, 0.65], [144769, 0.72], [189109, 0.79], [235601, 0.86], [284274, 0.93], [332895, 1.00]],
  ],
  WING: [
    ['do 3 m', 2000, 3000, [84241, 0.40], [122564, 0.49], [162285, 0.58], [204980, 0.67], [247565, 0.76], [296006, 0.85]],
    ['do 3,25 m', 3001, 3250, [87138, 0.43], [126419, 0.52], [167102, 0.61], [210777, 0.70], [254160, 0.79], [303603, 0.88]],
    ['do 3,5 m', 3251, 3500, [90007, 0.45], [130237, 0.54], [171873, 0.63], [216518, 0.72], [260692, 0.81], [311126, 0.90]],
    ['do 3,75 m', 3501, 3750, [94973, 0.48], [136485, 0.57], [179853, 0.66], [225932, 0.75], [271416, 0.84], [323336, 0.93]],
    ['do 4 m', 3751, 4000, [99893, 0.51], [142676, 0.60], [187760, 0.69], [235258, 0.78], [282040, 0.87], [335433, 0.96]],
    ['do 4,25 m', 4001, 4250, [107025, 0.54], [154438, 0.63], [202727, 0.72], [253513, 0.81], [306861, 0.90], [360292, 0.99]],
    ['do 4,5 m', 4251, 4500, [110329, 0.57], [158932, 0.66], [208272, 0.75], [260106, 0.84], [314469, 0.93], [368898, 1.02]],
    ['do 4,75 m', 4501, 4750, [113601, 0.61], [163381, 0.70], [213763, 0.79], [266633, 0.88], [322002, 0.97], [377417, 1.06]],
    ['do 5 m', 4751, 5000, [117040, 0.65], [167932, 0.74], [219366, 0.83], [273297, 0.92], [329757, 1.01], [386158, 1.10]],
  ],
  SUNSET: [
    ['do 3 m', 2000, 3000, [96840, 2.33], [129949, 2.40], [168529, 2.46], [207724, 2.53], [247999, 2.59], [294564, 2.66]],
    ['do 3,25 m', 3001, 3250, [101012, 2.33], [133250, 2.40], [172512, 2.46], [213914, 2.53], [253326, 2.59], [302014, 2.66]],
    ['do 3,5 m', 3251, 3500, [106481, 2.33], [142974, 2.40], [182055, 2.46], [223434, 2.53], [264160, 2.59], [316920, 2.66]],
    ['do 3,75 m', 3501, 3750, [110051, 2.33], [146138, 2.40], [185915, 2.46], [227993, 2.53], [272587, 2.59], [322903, 2.66]],
    ['do 4 m', 3751, 4000, [112495, 2.33], [149258, 2.40], [189713, 2.46], [235240, 2.53], [277675, 2.59], [328736, 2.66]],
    ['do 4,25 m', 4001, 4250, [121629, 2.33], [164828, 2.40], [212498, 2.46], [262332, 2.53], [309832, 2.59], [366237, 2.66]],
    ['do 4,5 m', 4251, 4500, [126975, 2.33], [172638, 2.40], [219444, 2.46], [268622, 2.53], [316809, 2.59], [376637, 2.66]],
    ['do 4,75 m', 4501, 4750, [130721, 2.33], [176058, 2.40], [223633, 2.46], [273576, 2.53], [325709, 2.59], [384408, 2.66]],
    ['do 5 m', 4751, 5000, [133298, 2.33], [179381, 2.40], [227699, 2.46], [281123, 2.53], [331178, 2.59], [390717, 2.66]],
    ['do 5,25 m', 5001, 5250, [135825, 2.33], [182640, 2.40], [233125, 2.46], [287315, 2.53], [338082, 2.59], [398478, 2.66]],
    ['do 5,5 m', 5251, 5500, [140973, 2.33], [188885, 2.40], [240512, 2.46], [293268, 2.53], [344614, 2.59], [405806, 2.66]],
  ],
}

// ==================== PŘÍPLATKY ====================
const surcharges = [
  // Dveře
  { code: 'doors_single_small', name: 'Jednokřídlé dveře do 1 m', category: SurchargeCategory.DOORS, type: SurchargeType.FIXED, value: 5000, sortOrder: 1 },
  { code: 'doors_single_large', name: 'Jednokřídlé dveře nad 1 m', category: SurchargeCategory.DOORS, type: SurchargeType.FIXED, value: 7000, sortOrder: 2 },
  { code: 'doors_side', name: 'Dveře pro boční vstup', category: SurchargeCategory.DOORS, type: SurchargeType.FIXED, value: 7000, sortOrder: 3 },
  { code: 'doors_lock', name: 'Uzamykání dveří', category: SurchargeCategory.DOORS, type: SurchargeType.FIXED, value: 800, sortOrder: 4 },
  { code: 'vent_flap', name: 'Větrací klapka', category: SurchargeCategory.DOORS, type: SurchargeType.FIXED, value: 7000, sortOrder: 5 },

  // Konstrukce
  { code: 'module_shorten', name: 'Zkrácení modulu', category: SurchargeCategory.CONSTRUCTION, type: SurchargeType.FIXED, value: 1500, sortOrder: 1 },
  { code: 'module_extend', name: 'Prodloužení modulu', category: SurchargeCategory.CONSTRUCTION, type: SurchargeType.FIXED, value: 3000, sortOrder: 2 },
  { code: 'module_extend_meter', name: 'Prodloužení modulu za metr', category: SurchargeCategory.CONSTRUCTION, type: SurchargeType.FIXED, value: 2000, sortOrder: 3 },
  { code: 'height_increase', name: 'Zvýšení zastřešení', category: SurchargeCategory.CONSTRUCTION, type: SurchargeType.PERCENT, value: 0.03, valueRock: 0.02, sortOrder: 4 },
  { code: 'mountain_reinforcement', name: 'Zpevnění pro podhorskou oblast', category: SurchargeCategory.CONSTRUCTION, type: SurchargeType.PERCENT, value: 0.15, sortOrder: 5 },
  { code: 'segment_lock', name: 'Uzamykání segmentu', category: SurchargeCategory.CONSTRUCTION, type: SurchargeType.FIXED, value: 1000, sortOrder: 6 },

  // Polykarbonát
  { code: 'poly_solid', name: 'Plný polykarbonát', category: SurchargeCategory.POLYCARBONATE, type: SurchargeType.FIXED, value: 1000, sortOrder: 1 },
  { code: 'poly_color_change', name: 'Změna barvy polykarbonátu', category: SurchargeCategory.POLYCARBONATE, type: SurchargeType.PERCENT, value: 0.07, sortOrder: 2 },
  { code: 'poly_plexi', name: 'Plexi', category: SurchargeCategory.POLYCARBONATE, type: SurchargeType.FIXED, value: 600, sortOrder: 3 },

  // Koleje
  { code: 'rail_meter', name: 'Jeden metr koleje', category: SurchargeCategory.RAILS, type: SurchargeType.FIXED, value: 220, valueRock: 330, sortOrder: 1 },
  { code: 'rail_walking', name: 'Pochozí kolejnice', category: SurchargeCategory.RAILS, type: SurchargeType.FIXED, value: 330, valueRock: 380, sortOrder: 2 },

  // Povrchová úprava
  { code: 'surface_bronze_elox', name: 'Bronzový elox', category: SurchargeCategory.SURFACE, type: SurchargeType.PERCENT, value: 0.05, sortOrder: 1 },
  { code: 'surface_anthracite_elox', name: 'Antracitový elox', category: SurchargeCategory.SURFACE, type: SurchargeType.PERCENT, value: 0.05, sortOrder: 2 },
  { code: 'surface_ral', name: 'RAL nástřik', category: SurchargeCategory.SURFACE, type: SurchargeType.PERCENT, value: 0.20, sortOrder: 3 },

  // Montáž
  { code: 'install_cz', name: 'Montáž v ČR', category: SurchargeCategory.INSTALLATION, type: SurchargeType.PERCENT, value: 0.06, valueRock: 0.08, minValue: 5500, sortOrder: 1 },
  { code: 'install_eu', name: 'Montáž v zahraničí', category: SurchargeCategory.INSTALLATION, type: SurchargeType.PERCENT, value: 0.08, valueRock: 0.10, sortOrder: 2 },
]

async function main() {
  console.log('Seeding database...')

  // Vyčistit existující data
  await prisma.quoteItem.deleteMany()
  await prisma.quote.deleteMany()
  await prisma.price.deleteMany()
  await prisma.roofType.deleteMany()
  await prisma.surcharge.deleteMany()
  await prisma.user.deleteMany()
  await prisma.settings.deleteMany()

  // Vytvořit typy zastřešení
  console.log('Creating roof types...')
  const roofTypeMap: Record<string, string> = {}

  for (const rt of roofTypes) {
    const created = await prisma.roofType.create({
      data: {
        code: rt.code,
        name: rt.name,
        maxWidth: rt.maxWidth,
        minWidth: rt.minWidth,
        hasSkirts: rt.hasSkirts,
        sortOrder: rt.sortOrder,
        image: `/images/${rt.code.toLowerCase()}.png`,
      },
    })
    roofTypeMap[rt.code] = created.id
  }
  console.log(`Created ${roofTypes.length} roof types`)

  // Vytvořit ceníky
  console.log('Creating prices...')
  let priceCount = 0

  for (const [roofCode, rows] of Object.entries(priceData)) {
    const roofTypeId = roofTypeMap[roofCode]
    if (!roofTypeId) {
      console.warn(`Roof type ${roofCode} not found, skipping prices`)
      continue
    }

    for (const row of rows) {
      const [widthLabel, widthMin, widthMax, ...modulePrices] = row

      for (let i = 0; i < modulePrices.length; i++) {
        const [price, height] = modulePrices[i] as [number, number]
        const modules = i + 2 // moduly jsou 2-7

        if (price > 0) {
          await prisma.price.create({
            data: {
              roofTypeId,
              widthLabel: widthLabel as string,
              widthMin: widthMin as number,
              widthMax: widthMax as number,
              modules,
              price,
              height,
            },
          })
          priceCount++
        }
      }
    }
  }
  console.log(`Created ${priceCount} prices`)

  // Vytvořit příplatky
  console.log('Creating surcharges...')
  for (const s of surcharges) {
    await prisma.surcharge.create({ data: s })
  }
  console.log(`Created ${surcharges.length} surcharges`)

  // Vytvořit admin uživatele
  console.log('Creating admin user...')
  const hashedPassword = await bcrypt.hash('admin123', 12)
  await prisma.user.create({
    data: {
      email: 'admin@alupol.cz',
      name: 'Administrátor',
      password: hashedPassword,
      role: UserRole.ADMIN,
    },
  })
  console.log('Created admin user: admin@alupol.cz / admin123')

  // Vytvořit nastavení
  console.log('Creating settings...')
  const settings = [
    { key: 'company_name', value: 'ALUPOL', description: 'Název společnosti' },
    { key: 'quote_validity_months', value: '3', description: 'Platnost nabídky v měsících' },
    { key: 'transport_rate_default', value: '19', description: 'Výchozí sazba za km' },
  ]

  for (const s of settings) {
    await prisma.settings.create({ data: s })
  }
  console.log(`Created ${settings.length} settings`)

  console.log('Seeding completed!')
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
